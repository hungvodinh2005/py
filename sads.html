<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Register & Login Modal</title>
    <style>
      body {
        font-family: Arial;
        margin: 0;
        padding: 0;
      }

      #mainContent {
        padding: 20px;
        height: 800px;
        background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
      }

      /* Overlay chung */
      #overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(3px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 999;
        display: none; /* mặc định ẩn */
      }

      /* Popup chung */
      .popup {
        background: rgba(255, 255, 255, 0.95);
        padding: 20px;
        border-radius: 10px;
        width: 300px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      }

      .popup input,
      .popup button {
        width: 100%;
        margin: 5px 0;
        padding: 8px;
        box-sizing: border-box;
      }

      .popup button {
        background-color: #28a745;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      .popup button:hover {
        background-color: #218838;
      }

      .switchLink {
        text-align: center;
        margin-top: 10px;
        cursor: pointer;
        color: #007bff;
      }

      #message {
        color: red;
        text-align: center;
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div id="mainContent">
      <h1>Dashboard</h1>
      <p>Bạn sẽ không thể tương tác nếu chưa đăng nhập.</p>
      <button onclick="alert('Tương tác dashboard!')">Test</button>
      <p>Cuộn thử nội dung phía sau...</p>
      <div style="height: 800px; background: #f0f0f0; margin-top: 10px"></div>
    </div>

    <!-- Overlay -->
    <div id="overlay">
      <!-- Register popup -->
      <div id="registerBox" class="popup">
        <h3>Đăng ký</h3>
        <form id="registerForm">
          <input
            type="text"
            id="regUsername"
            placeholder="Tài khoản"
            required
          />
          <input
            type="password"
            id="regPassword"
            placeholder="Mật khẩu"
            required
          />
          <button type="submit">Đăng ký</button>
        </form>
        <div class="switchLink" onclick="showLogin()">
          Đã có tài khoản? Đăng nhập
        </div>
        <p id="regMessage"></p>
      </div>

      <!-- Login popup -->
      <div id="loginBox" class="popup" style="display: none">
        <h3>Đăng nhập</h3>
        <form id="loginForm">
          <input
            type="text"
            id="loginUsername"
            placeholder="Tài khoản"
            required
          />
          <input
            type="password"
            id="loginPassword"
            placeholder="Mật khẩu"
            required
          />
          <button type="submit">Đăng nhập</button>
        </form>
        <div class="switchLink" onclick="showRegister()">
          Chưa có tài khoản? Đăng ký
        </div>
        <p id="loginMessage"></p>
      </div>
    </div>

    <script>
      // Database giả lập
      const users = {};

      // Hiển thị overlay với popup register
      function showRegister() {
        document.getElementById("overlay").style.display = "flex";
        document.getElementById("registerBox").style.display = "block";
        document.getElementById("loginBox").style.display = "none";
      }

      // Hiển thị overlay với popup login
      function showLogin() {
        document.getElementById("overlay").style.display = "flex";
        document.getElementById("loginBox").style.display = "block";
        document.getElementById("registerBox").style.display = "none";
      }

      // Khi load trang -> hiện đăng ký trước
      showRegister();

      // Xử lý đăng ký
      document
        .getElementById("registerForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const username = document.getElementById("regUsername").value;
          const password = document.getElementById("regPassword").value;

          if (users[username]) {
            document.getElementById("regMessage").textContent =
              "Tài khoản đã tồn tại!";
          } else {
            users[username] = password;
            document.getElementById("regMessage").textContent =
              "Đăng ký thành công!";
            setTimeout(showLogin, 1000); // tự động chuyển sang login sau 1s
          }
        });

      // Xử lý đăng nhập
      document
        .getElementById("loginForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const username = document.getElementById("loginUsername").value;
          const password = document.getElementById("loginPassword").value;

          if (users[username] && users[username] === password) {
            document.getElementById("loginMessage").textContent =
              "Đăng nhập thành công!";
            // Ẩn overlay
            document.getElementById("overlay").style.display = "none";
          } else {
            document.getElementById("loginMessage").textContent =
              "Sai tài khoản hoặc mật khẩu";
          }
        });
    </script>
  </body>
</html>
